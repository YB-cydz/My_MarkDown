

# 1.机器人模型错位

学习小鱼的教程时，他提出了URDF中机器人的轮子会埋在地面的常见错误，他的解决方法是增加一个虚拟部件`base_footprint`，然后让其作为`base_link`的父节点，通过`joint`使整个机器人上移

想到我在做RM正式考核时的URDF似乎也没考虑这个问题，我考虑回去解决一下

考虑到尽量不新加tf节点，我通过为各个部件添加初始z的偏置解决了这一问题

# 2.各个部件的静态tf未发布

可能是未使用joint_state_publisher的原因,测试证明是未使用robot_state_publisher的原因

# 3.No module named ‘tf_transformations‘

如果有人想要这个包的话，可以去这找https://github.com/DLu/tf_transformations

解决这种问题有个核心点：ROS2环境默认会去你系统python默认路径下找包，而不会去你的工程文件目录下找这个类的定义，所以你的包必须放进python默认路径下，重新编译环境后再去跑你的项目。

首先运行python3 -m site去找你的python安装目录，一般默认都是安装在/home/user/.local/lib/python3.10/site-packages这里。

把tf_transformations放进去，注意别把你从github下载的整个包放进去了，只需要里面的tf_transformations文件夹，使用git文件时一定要先阅读他的README.txt。
# 4.为什么打开建图之后原先建好的地图没了

因为**Cartographer**建图的`/map`对静态地图进行了覆盖

# 5.为什么不开建图，在有先验地图的情况下也能跑nav2

 **Nav2 的定位模块（如 AMCL）可以直接利用预先构建好的地图进行定位**，而无需实时生成地图。

**定位模块（Localization）**使用定位算法`AMCL`（自适应蒙特卡洛定位），根据预先提供的地图，结合机器人的传感器数据（如激光雷达、里程计），通过概率模型估计机器人的准确位置。

这里的`odom`是由**仿真中的 odom（Gazebo / Ignition）**

Gazebo 插件

```xml
<plugin name="diff_drive" filename="libgazebo_ros_diff_drive.so">
```

# 6.为什么刚启动nav2时tf没有`map`但是提供初始位姿之后能导航

而由于有静态地图，话题`/map`是一直有的

因为此时AMCL因为没有初始位姿而没能启动，提供初始位姿之后AMCL启动后发布 `map` →` odom`，也就有了一颗完整的tf树

# 7.关于川大的无先验地图的launch中看到发布`map` -> `odom`的静态变换

相当于将里程计原点与地图原点重合即里程计的位姿就是当前机器人的位姿，对于边建图边导航逻辑上确实没问题

而在有先验地图的条件下将会发布的动态tf变换其实就是机器人在地图中的坐标

总结就是`map` -> `odom`的作用是确定启动位置